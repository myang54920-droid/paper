<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ë“¤ë§Œì˜ ë¡¤ë§í˜ì´í¼</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background-color: #f5f7f9; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        .container { width: 100%; max-width: 450px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.05); box-sizing: border-box; }
        h2 { text-align: center; color: #333; margin-bottom: 25px; font-size: 20px; }
        input, textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #eee; border-radius: 12px; box-sizing: border-box; font-size: 16px; background: #fafafa; }
        button { width: 100%; padding: 14px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; margin-bottom: 10px; }
        .btn-write { background-color: #00c853; color: white; }
        .btn-read { background-color: #2979ff; color: white; }
        .msg-card { background: #fff; padding: 20px; margin-top: 15px; border-radius: 12px; border: 1px solid #f0f0f0; border-left: 5px solid #ffd600; position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .msg-text { font-size: 16px; color: #333; line-height: 1.5; margin-bottom: 15px; word-break: break-all; }
        .msg-footer { display: flex; justify-content: space-between; align-items: center; }
        .msg-time { font-size: 11px; color: #bbb; }
        .btn-del-req { font-size: 11px; color: #ff5252; background: none; border: 1px solid #ff5252; padding: 4px 8px; cursor: pointer; border-radius: 5px; }
        .notice-card { border-left: 5px solid #ff9800 !important; background: #fffaf0 !important; }
        .notice-tag { color: #ff9800; font-size: 12px; font-weight: bold; margin-bottom: 8px; }
        .admin-link { margin-top: 40px; font-size: 12px; color: #ddd; cursor: pointer; text-align: center; }
        #adminArea { display:none; width: 100%; }
        hr { margin: 30px 0; border: 0; border-top: 1px solid #eee; }
    </style>
</head>
<body>

<div class="container">
    <h2>âœï¸ í¸ì§€ ë‚¨ê¸°ê¸°</h2>
    <input list="nameList" id="targetName" placeholder="ë°›ëŠ” ì‚¬ëŒ ì´ë¦„ ê²€ìƒ‰">
    <datalist id="nameList"></datalist>
    <textarea id="message" rows="4" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    <button class="btn-write" onclick="writeMsg()">í¸ì§€ ë³´ë‚´ê¸°</button>
    <hr>
    <h2>ğŸ” ë‚´ í¸ì§€í•¨ í™•ì¸</h2>
    <input list="nameList" id="myName" placeholder="ë‚´ ì´ë¦„ ê²€ìƒ‰">
    <input type="password" id="myPw" placeholder="ë‚˜ë§Œ ì•„ëŠ” ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
    <button class="btn-read" onclick="readMsg()">ë³´ì•ˆ ì—´ëŒí•˜ê¸°</button>
    <div id="display"></div>
    <div class="admin-link" onclick="toggleAdmin()">ê´€ë¦¬ì ëª¨ë“œ</div>
    <div id="adminArea">
        <input type="password" id="adminPw" placeholder="ê´€ë¦¬ì ë¹„ë²ˆ">
        <button onclick="loadAdminMsgs()" style="background:#555; color:white;">ì „ì²´ ì¡°íšŒ</button>
        <div id="adminDisplay"></div>
    </div>
</div>

<script>
    const members = ["ì•ˆí˜ì§„ ë³¸ë¶€ì¥", "ë°±ì•„í˜„ ë¶€ë³¸ë¶€ì¥", "ì´ë¶„í¬ ë³¸ë¶€ì¥", "ê°œì²­ìš´ ë¶€ë³¸ë¶€ì¥", "ê°€í˜„ìš° ëŒ€ë¦¬", "ë§ˆì²œìš° ëŒ€ë¦¬", "ì„œì´ì¤€ ê³¼ì¥", "í•œìœ¨ ëŒ€ë¦¬", "ì„œí›ˆ ëŒ€ë¦¬", "ê°€ë¹„ìš° ì‚¬ì›", "ê°•ìŠ¹í˜œì‚¬ì›", "ê°•ìœ ì§„ ì£¼ì„", "ê²Œêµ­ì§€ ì‚¬ì›", "ê³ ë´‰ì‹ ëŒ€ë¦¬", "ê³½ìš©íŒ” ëŒ€ë¦¬", "êµ¬ìˆœë˜ ì‚¬ì›", "êµ¬ìœ¤í˜¸ ì‚¬ì›", "ê¹€ì„ í¬ ì‚¬ì›", "ë‹¹ì‹œì•„ ì‚¬ì›", "ë£¨ë£¨ì™€ ì‚¬ì›", "ë§ˆí’ê°• ì‚¬ì›", "ë¯¼ì§€ì„± ì‚¬ì›", "ë°•ê·œì‹ ì‚¬ì›", "ë°•ì„±ì€ ëŒ€ë¦¬", "ë°°í•˜ì§„ ì¸í„´", "ë°±ì€í˜¸ ì‚¬ì›", "ë°±ì •í›ˆ ê³¼ì¥", "ë°±í¬ ì£¼ì„", "ì„œì—¬ë¦¬ ì£¼ì„", "ì„œìœ¤ì„œ ì‚¬ì›", "ì„œìœ¤ì œ ì£¼ì„", "ì„ ì£¼í˜œ ì¸í„´", "ì†Œë„ë¦¬ ì£¼ì„", "ì†Œí•œë¹ˆ ì‚¬ì›", "ì‹ ì‹œì•„ ì‚¬ì›", "ì–‘í•´ì§„ ëŒ€ë¦¬", "ì—„í‘ë¯¼ ì‚¬ì›", "ì˜ˆê·œë¹ˆ ì‚¬ì›", "ìœ ì—¬í•œ ëŒ€ë¦¬", "ìœ ì¬ë¯¼ ì‚¬ì›", "ìœ¤ íƒ ì‚¬ì›", "ìœ¤ê²¬ ëŒ€ë¦¬", "ìœ¤ì£¼ì› ì£¼ì„", "ìœ¤íƒœì¤€ ëŒ€ë¦¬", "ì´ë‹¤ì†” ì‚¬ì›", "ì´ë™ì‹ ëŒ€ë¦¬", "ì´ë¦¬ë‚˜ ëŒ€ë¦¬", "ì´ë¯¸ì§€ ì‚¬ì›", "ì´ì•„ëŒ ëŒ€ë¦¬", "ì´í•´ë¯¸ ì¸í„´", "ìì†Œí¬ ì‚¬ì›", "ì¥ì˜ì‚¬ ì£¼ì„", "ì • ìœ¤ ê³¼ì¥", "ì§€ì‚° ëŒ€ë¦¬", "ì°¨ê±´ìš° ì‚¬ì›", "ì°¨ì§€ì•ˆ ì‚¬ì›", "ì°¨ì§€ì˜¨ ì‚¬ì›", "ì°¨í˜„ ì‚¬ì›", "ì±„ì„œë¦° ëŒ€ë¦¬", "ì±„ì´ì„¤ ëŒ€ë¦¬", "í•¨ì±„ë¯¸ ì‚¬ì›", "í—ˆì±„í—Œ ì‚¬ì›", "í˜¸ê°•ì„¸ ê³¼ì¥"];
    
    // â­ ì—¬ê¸°ì— êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ë°°í¬ URLì„ ê¼­ ë„£ì–´ì£¼ì„¸ìš”!
    const APP_URL = "ì—¬ê¸°ì—_URLì„_ë„£ìœ¼ì„¸ìš”";

    // ëª©ë¡ ë„ìš°ê¸° ì‹¤í–‰
    const dataList = document.getElementById('nameList');
    members.sort().forEach(n => { 
        const o = document.createElement('option'); 
        o.value = n; 
        dataList.appendChild(o); 
    });

    async function writeMsg() {
        const name = document.getElementById('targetName').value;
        const msg = document.getElementById('message').value;
        if(!msg) return alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.");
        // 'ì „ì²´' í˜¹ì€ ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” ì´ë¦„ë§Œ ê°€ëŠ¥
        if(name !== "ì „ì²´" && !members.includes(name)) return alert("ëª©ë¡ì— ìˆëŠ” ì´ë¦„ì„ ì„ íƒí•˜ê±°ë‚˜ 'ì „ì²´'ë¼ê³  ì…ë ¥í•˜ì„¸ìš”.");
        
        await fetch(APP_URL, { method: 'POST', body: JSON.stringify({ action: 'write', name, msg }) });
        alert("ë³´ëƒˆìŠµë‹ˆë‹¤!"); 
        location.reload();
    }

    async function readMsg() {
        const name = document.getElementById('myName').value;
        const pw = document.getElementById('myPw').value;
        const disp = document.getElementById('display');
        if(!name || !pw) return alert("ì´ë¦„ê³¼ ë¹„ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”.");
        disp.innerHTML = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";
        
        try {
            const res = await fetch(APP_URL, { method: 'POST', body: JSON.stringify({ action: 'read', name, pw }) });
            const msgs = await res.json(); 
            
            disp.innerHTML = msgs.length ? "" : "ë‚´ìš©ì´ ì—†ê±°ë‚˜ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.";
            
            msgs.reverse().forEach(m => {
                // ì´ë¦„ì´ 'ì „ì²´'ì¸ ê²½ìš°ì™€ ë³¸ì¸ì¸ ê²½ìš° êµ¬ë¶„
                const isAll = (m.name === "ì „ì²´" || m.sender === "ì „ì²´");
                disp.innerHTML += `
                    <div class="msg-card ${isAll ? 'notice-card' : ''}">
                        ${isAll ? '<div class="notice-tag">ğŸ“¢ ì „ì²´ê³µì§€</div>' : ''}
                        <div class="msg-text">${m.msg}</div>
                        <div class="msg-footer">
                            <span class="msg-time">${new Date(m.time).toLocaleDateString()}</span>
                            ${!isAll ? `<button class="btn-del-req" onclick="requestDelete('${name}', '${m.msg}')">ì‚­ì œìš”ì²­</button>` : ''}
                        </div>
                    </div>`;
            });
        } catch(e) { 
            disp.innerHTML = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. URLì„ í™•ì¸í•´ì£¼ì„¸ìš”."; 
        }
    }

    function toggleAdmin() { const a = document.getElementById('adminArea'); a.style.display = a.style.display === 'none' ? 'block' : 'none'; }
    async function loadAdminMsgs() {
        const pw = document.getElementById('adminPw').value;
        const res = await fetch(APP_URL, { method: 'POST', body: JSON.stringify({ action: 'adminRead', pw }) });
        const data = await res.json();
        const disp = document.getElementById('adminDisplay');
        if(data.length === 0) { disp.innerHTML = "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."; return; }
        disp.innerHTML = data.map(m => `<div style="background:#eee; padding:10px; margin-top:5px; border-radius:8px;"><b>[${m.name}]</b> ${m.msg} <br><button onclick="adminDelete(${m.id})" style="background:red; color:white; font-size:10px; width:auto; padding:2px 5px;">ì§„ì§œì‚­ì œ</button></div>`).join('');
    }
    async function adminDelete(rowId) {
        if(!confirm("ì •ë§ ì§€ì›ë‹ˆê¹Œ?")) return;
        const pw = document.getElementById('adminPw').value;
        await fetch(APP_URL, { method: 'POST', body: JSON.stringify({ action: 'adminDelete', pw, rowId }) });
        alert("ì‚­ì œë¨"); loadAdminMsgs();
    }
    async function requestDelete(name, msg) {
        if(!confirm("ìš´ì˜ìì—ê²Œ ì‚­ì œë¥¼ ìš”ì²­í• ê¹Œìš”?")) return;
        await fetch(APP_URL, { method: 'POST', body: JSON.stringify({ action: 'requestDelete', name, msg }) });
        alert("ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }
</script>
</body>
</html>
